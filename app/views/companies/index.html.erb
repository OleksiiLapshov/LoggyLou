<% content_for :title, "Companies" %>

<div class="w-full max-w-4xl mx-auto mt-6 px-4 form-card">
  <div class="flex items-center justify-between mb-6">
    <h1 class="text-3xl font-bold text-zinc-800">Companies</h1>
    <%= link_to "New Company", new_company_path, class: "button-success" if current_user_admin? %>
  </div>

  <div class="grid gap-6 md:grid-cols-2 ">
    <% @companies.each do |company| %>
      <div class="form-card hover:scale-[1.01] transition-transform duration-200">
        <div class="flex items-center justify-between mb-4">
          <h2 class="text-xl font-bold text-gray-900 dark:text-zinc-800">
            <%= company.name %>
          </h2>
          <span class="px-2 py-1 text-xs font-medium bg-indigo-100 text-indigo-800 rounded-md dark:bg-indigo-500/50 dark:text-white">
            <%= pluralize(company.projects.count, 'Project') %>
          </span>
        </div>

        <% if company.projects.any? %>
          <div class="space-y-2 mb-10">
            <p class="text-xs font-semibold text-gray-500 uppercase tracking-wider">Active Projects</p>
            <ul class="space-y-1">
              <% company.projects.each do |project| %>
                <li class="flex items-center gap-2 text-sm text-gray-700 dark:text-zinc-600">
                  <%= heroicon "folder", variant: :mini, options: { class: "w-4 h-4 text-gray-400" } %>
                  <%= link_to "#{project.name}", project, class: "underline" %>
                </li>
              <% end %>
            </ul>
          </div>
        <% else %>
          <p class="text-sm text-gray-500 italic">No active projects</p>
        <% end %>
        
        <div class="my-6 pt-4 border-t border-gray-700 flex justify-between items-center absolute bottom-0 gap-x-6">
   
          <%= link_to "Edit Company", edit_company_path(company), class: "text-sm text-indigo-500 hover:text-indigo-400 font-medium" %>

          <%= link_to new_company_project_path(company_id: company.id), class: "flex items-center gap-1 text-sm text-green-600 hover:text-green-700 font-medium" do %>
            <%= heroicon "plus", variant: :mini, options: { class: "w-4 h-4" } %>
            <span>Add Project</span>
          <% end %>

        </div>
      </div>
    <% end %>
  </div>
</div>